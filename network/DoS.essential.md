---
author: Artem Zhivushko
title: DoS.essential
create: 2024-03-27 03:53:23
tags:
  - ZeroToHero
  - DevSecOps
  - dos
  - ddos
---
# Denial of Service (DoS)

> **Denial of Service (DoS), или «Отказ в обслуживании»**, — это перегрузка информационной системы, в которой работает сервисы, с помощью сетевых запросов. При этом сами запросы на сетевом уровне осуществляются с одного компьютера и нацелены на конкретный виртуальный сервер или домен.

> **Distributed Denial of Service (DDoS), или «Распределенный отказ в обслуживании»**, — это перегрузка информационной системы избыточным числом запросов, блокирующая обработку обращений.

---
# Классификация инцидентов информационной безопасности

Инциденты принято разделять: 

- по типам (или видам), 
- по степени критичности (или степени возможно ущерба) для организации.

При **классификации по типам или видам** чаще всего используются категории, описанные в нормативных документах и стандартах, или определенные самими организациями. 

Для примера рассмотрим стандарт ISO/IEC 27035-1. Он определяет принципы управления инцидентами ИБ, а также содержит примеры типов инцидентов ИБ и типизацию, предлагаемую Национальным координационным центром по компьютерным инцидентам (НКЦКИ). 

|**Тип инцидента по ISO/IEC 27035-1**|**Тип инцидента по НКЦКИ**|
|---|---|
|Отказ в обслуживании (Denial  <br>of Service, DoS)|Нарушение или замедление  <br>работы контролируемого информационного ресурса (availability)|
|Неавторизованный доступ (Unauthorized access)|Несанкционированный доступ  <br>в систему (intrusion)|
|Заражение вредоносным кодом (Malware)|Заражение вредоносным программным обеспечением (malware)|
||Распространение вредоносного программного обеспечения (malware distribution)|
|Нарушение политик информационной безопасности (Abuse)|Нарушение безопасности информации (information  <br>content security)|
||Мошенничество с использованием ИКТ (fraud)|
||Распространение информации  <br>с неприемлемым содержимым (abusive content)|
|Сбор информации (Information gathering)|Сбор сведений с использование ИКТ (information gathering)|

Что касается **определения степени критичности инцидента ИБ**, как правило, оно выполняется организацией самостоятельно для каждого инцидента/типа инцидента. При оценке используются результаты оценки рисков, экспертные оценки и другие характеристики.

---
# Виды DDoS-атак
## Классификация относительно модели OSI

Сетевая модель стека сетевых протоколов, которая описывает работу Интернета, называется — OSI. Она состоит из 7 уровней: физического, канального, сетевого, транспортного, сеансового, уровня представления и прикладного (или уровня приложений).

![Схема уровней модели OSI](https://telegra.ph/file/883545be699304d8b155c.png)

Каждый протокол сети, по которому передаются данные, относится к определенному уровню.
### Атаки транспортного уровня

Атака направлена на перегрузку брандмауэра, центральной сети или системы, распределяющей нагрузку. При атаках такого вида распространено использование сетевого флуда, при котором генерируется масса однотипных запросов-пустышек, перегружающих канал. Основной упор здесь делается на методику обработки клиентских запросов к серверу.

Как правило, сетевая служба работает по методу FIFO, согласно которому в приоритете первое обращение. Однако, при флуде генерируется такой объем запросов, что аппаратных ресурсов сервера не хватает для завершения обработки первого запроса.
#### 1-й уровень — физический

Канал работает с данными типа «биты» и обеспечивает передачу необработанных двоичных данных между машинами. Использует протоколы Bluetooth, USB, ИК-порт, а также концентраторы, розетки и патч-панели.

**Пример атаки:** на данном уровне DoS или DDoS невозможна. Первому уровню могут навредить физические разрушения или любые другие преграды в работе сети. Искусственно созданные сбои ведут к полной непригодности оборудования.
#### 2-й уровень — канальный

Канальный уровень отвечает за обмен данными между узлами внутри локальной сети. Данные оформляются в специальные блоки — кадры — и передаются на физический уровень. Еще одна функция канального уровня — присвоение уникальных идентификаторов сетевых адаптеров — MAC-адресов.

**Пример атаки:** самая распространенная — [MAC-флуд](#MAC-флуд). Сетевые коммутаторы нагружаются пакетами данных, чтобы вывести из строя все порты соединения.
##### MAC-флуд

На порты сервера поступает поток пустых пакетов с пустыми MAC-адресами.
#### 3-й уровень — сетевой

На этом уровне начинается взаимодействие маршрутизаторов и коммутаторов, расположенных в разных сетях. Маршрутизация строится на преобразовании MAC-адресов в сетевые адреса. Главная задача данного уровня — построить наиболее оптимальный путь для передачи данных между устройствами.

**Пример атаки:** злоумышленники создают [ICMP-флуд](#ICMP-флуд), чтобы перегрузить ICMP-сообщениями целевую сеть. Эти действия направлены на снижение пропускной способности и ограничение числа запросов, которое возможно обработать по ICMP-протоколу.
##### ICMP-флуд

![](https://selectel.ru/blog/wp-content/uploads/2020/09/PR-14317_2.png)

Перегружает сервер жертвы служебными командами, на которые машина должна давать эхо-ответы. Классический пример DDoS-атаки — Ping-флуд, когда на сервер непрерывно отправляются ICMP-пакеты для проверки доступности узла.

> При таких атаках используются заложенные в серверное ПО упущения, создающие уязвимости. Классический пример — атака «Пинг смерти», когда на атакуемую машину направляется избыточный объем ICMP-пакетов, переполняющих буфер памяти.
#### 4-й уровень — транспортный

Он использует протоколы [UDP](#UDP-флуд) и TCP, а также обрабатывает и транспортирует пакеты данных между узлами связи. Четвертый уровень контролирует поток информации и выявляет ошибки. В случае их обнаружения отправляет данные повторно.

**Пример атаки:** хакеры создают условия, при которых превышаются пороговые значения по ширине канала и количеству доступных подключений. Самые распространенные типы DDoS-атак — Smurf и [SYN-флуд](#SYN-флуд).
##### SYN-флуд

![](https://selectel.ru/blog/wp-content/uploads/2020/09/PR-14317_5.png)

На сервер отправляется избыточный объем SYN-запросов на TCP-подключение. Согласно алгоритму «‎тройного рукопожатия», сервер должен ответить на SYN-запрос клиента пакетом с флагом ACK (Аcknowledge). После этого будет установлено соединение. В случае с SYN-флудом, очередь SYN-пакетов на сервере переполняется.

При этом заголовки SYN-пакетов подделываются таким образом, чтобы ответные пакеты с сервера уходили на несуществующие адреса. Таким образом, злоумышленник создает цепочку наполовину открытых соединений, забивающих канал и делающих невозможным доступ рядовых пользователей к серверу и его службам.
##### UDP-флуд

![](https://selectel.ru/blog/wp-content/uploads/2020/09/PR-14317_1.png)

Атакуемое устройство получает множественные UDP-запросы с измененными IP-адресами источников. Так злоумышленник сохраняет анонимность паразитной сети, забивая полосу пропускания сервера. Суть атаки в следующем: из вредоносной сети на жертву направляется поток запросов по протоколу UDP. Сервер должен обработать запрос, разобрав приходящий пакет и определив для него соответствующее приложение (сервис, порт).

Затем нужно перенаправить запрос туда и в случае успеха вернуть ответ службы. В случае отсутствия активности будет отправлено сообщение «Адресат недоступен» по протоколу ICMP. Поскольку в пакетах был изменен адрес источника инициатора запроса, то ICMP-отказы уходят на другие узлы. Тем временем, вредоносный алгоритм продолжает поддерживать очередь запросов переполненной.
### Высокоуровневые атаки
#### 5-й уровень — сеансовый

Пятый уровень управляет взаимодействием между приложениями, а также устанавливает и завершает соединение, синхронизирует задачи операционной системы.

**Пример атаки:** атакующий использует слабые места программного обеспечения через протокол Telnet, что может привести к потере доступа над сервером у администратора.
#### 6-й уровень — представления

Уровень кодирует/декодирует данные и адаптирует их для человека или машины, в понятном им виде. Сюда входят видеоданные, аудиоданные, изображения и текст. Между 6 и 7 уровнем модели OSI находится SSL-протокол. Он обеспечивает клиенту безопасное соединение с сервером и предоставляет возможность взаимной проверки подлинности.

**Пример атаки:** SSL-флуд измененными пакетами — злоумышленники генерируют искаженные SSL-запросы для атак на сервер жертвы. Действия тормозят ресурсы, так как проверка шифрованных SSL-пакетов занимает много времени.
#### 7-й уровень — прикладной или уровень приложений

Атаки уровня приложения L7 модели OSI подвергаются оперативная память, процессорное время, а также подсистема хранения данных на сервере. При этом пропускной канал не перегружается.

Прикладной уровень работает уже целиком для пользователя и предоставляет ему данные в понятном для него виде.

**Пример атаки:** хакеры с помощью вредоносных программ создают большое количество запросов — [HTTP-флуд](# HTTP-флуд): на подключение, на ввод логинов, на заказ товара, загрузку видео и т.д. В тоже время, легитимные пользователи не могут попасть на сайт, так как он перегружен мусорными запросами.
##### Вычисления

Процессор получает запросы на «тяжелые» вычисления. Ввиду переизбытка запросов сервер начинает сбоить и пользователи не получают доступ к серверу, его службам и ресурсам.
##### Переполнение диска

Дисковое пространство сервера начинает заполняться «мусорным» содержимым с помощью вредоносного кода злоумышленников. Переполнение диска нарушает работу веб-серверов, функционал которых построен на активной работе с файловой системой (хранение, доступ и воспроизведение мультимедиа и другого контента). Для заполнения используются лог-файлы (данные о запросах и сессиях, формируемые на стороне сервера). Предотвратить умышленное заполнение диска можно ограничив размер лог-файлов.
##### Обход системы квотирования

Злоумышленник получает доступ к CGI-интерфейсу сервера и с его помощью использует аппаратные ресурсы машины в своих интересах.
##### Неполная проверка пользователя

Злоумышленник может использовать ресурсы сервера бесконечно долго.
##### Атака второго рода

На сервере вызывается ложный сигнал о перегрузке, либо ее угрозе, в результате сетевой узел на время становится недоступным.
## Классификация DDoS-атак по механизму действия

В этом типе классификаций мы выделим 3 группы DDoS-атак разного механизма действия:

1. [[#Первая группа — это атаки, направленные на переполнение канала связи, иными словами, различные типы флуда. | Атаки на основе флуда]].
2. [[#Вторая группа — это атаки, использующие уязвимости стека сетевых протоколов| Атаки, использующие уязвимости стека сетевых протоколов.]]
3. [[#Третья группа — это DDoS-атаки на уровень приложений (L7) | Атаки на уровень приложений.]]

---
### Первая группа — это атаки, направленные на переполнение канала связи, иными словами, различные типы флуда.
#### NS-амплификация

У публичного DNS-сервера запрашивают данные о домене и направляют его ответ на атакуемый сервер. Запрос формируется таким образом, чтобы в ответ вернулось как можно больше данных.
#### Фрагментированный UDP-флуд

Атакующий использует пакеты максимально допустимого размера, чтобы заполнить канал минимальным количеством пакетов. Фрагменты пакетов являются фальсифицированными и сервер-жертва тратит все ресурсы для того, чтобы восстанавливать несуществующие пакеты из фальшивых фрагментов.
#### CMP-флуд

На сервер-жертву посылается большое количество поддельных ICMP-пакетов с широкого диапазона IP-адресов. Цель злоумышленника — заполнение канала сервера-жертвы потоком поддельных запросов.
#### NTP-амплификация

Атакующий многократно отправляет запрос monlist на NTP-сервер, одновременно подменяя свой IP-адрес на адрес сервера-жертвы. Ответ monlist может содержать список до 600 последних клиентов. Цель атаки — небольшим запросом отправить большой поток UDP-трафика на сервер-жертву.
#### NTP-флуд

Хакер генерирует большое количество поддельных NTP-запросов с широкого диапазона IP-адресов. NTP-сервер пытается обработать все запросы, тем самым тратя системные и сетевые ресурсы.
#### Фрагментированный ACK-флуд

Используются пакеты максимально допустимого размера для заполнения полосы пропускания канала, при небольшом количестве передаваемых пакетов.
#### Ping-флуд

Разновидность ICMP-флуд, нацеленная на выведение из строя сервера, с помощью утилиты ping.
#### UDP-флуд с помощью ботнета

Алгоритм атаки схож с обычным UDP-флудом, за исключением одного —  пакеты генерируются ботами. Системные ресурсы заполняют нецелевым трафиком и они выходят из строя.
#### VoIP-флуд

На сервер-жертву отправляют большое количество поддельных VoIP- пакетов с широкого диапазона IP-адресов. Сервер тратит все ресурсы, чтобы обработать как поддельные, так и легитимные запросы.  
#### Флуд медиа-данными

Злоумышленник отправляет большое количество поддельных пакетов с видео- или аудио-данными на сервер-жертву. Сетевое оборудование вынуждено тратить вычислительные ресурсы на их обработку.
#### Атака широковещательными UDP-пакетами

Кибератака строится на отправке UDP-пакетов с подмененным IP-адресом, в расчете на то, что каждый из этих пакетов будет отправлен каждому из клиентов этой сети.
##### **Фрагментированный ICMP-флуд**

На сервер-жертву направляется поток фрагментированных ICMP-пакетов максимального размера. Полоса забивается мусорным трафиком, и возникает опасность исчерпания вычислительных ресурсов.
#### DNS-атаки

Атаки этого вида направлены на:

- **Использование уязвимостей в ПО DNS-серверов**: «уязвимость нулевого дня», «Быстрый поток», «DNS-спуфинг».
- **Обрушение DNS-серверов**: из-за отключения службы DNS пользователь не сможет зайти на страницу сайта, поскольку его браузер не найдет IP-адрес нужного узла.
##### DNS-флуд

На атакуемый DNS-сервер направляется масса DNS-запросов с широкого диапазона IP-адресов. Сервер-жертва не может определить, какой из пакетов пришел от легитимного пользователя, а какой — нет, и вынужден отвечать на все запросы.

---
### Вторая группа — это атаки, использующие уязвимости стека сетевых протоколов:
#### Атаки с модификацией поля TOS

Атакующий создает иллюзию перегруженности сети, и сервер самостоятельно ограничивает пропускную способность для подключений. Для этого хакеры используют поля TOS и ECN в IP-пакетах.
#### ACK-флуд  

Злоумышленники отправляют на сервер-жертву фальсифицированные  ACK-пакеты, не принадлежащие ни одной из сессий в списке соединений сервера. Атакуемый сервер не может определить принадлежность поддельных пакетов и выходит из строя.
#### RST, FIN-флуд

Сервер-жертва получает поддельные RST- или FIN-пакеты, не имеющие отношения ни к одной из сессий в базе данных сервера.
#### Атака поддельными TCP-сессиями с несколькими SYN-ACK

Хакер генерирует поддельные сессии несколькими SYN- и ACК-пакетами. Это позволяет обойти механизмы защиты и создать трафик, похожий на легитимный.
#### Атака с помощью перенаправления трафика высоконагруженных сервисов

Алгоритм заключается в перенаправлении трафика легитимных пользователей высоконагруженных приложений на сервер-жертву. Это ведет к сбою в работе из-за установки большого количества соединений.
#### Атака поддельными TCP-сессиями с несколькими ACK

Этот вариант атаки поддельной сессией выполняется несколькими SYN- и несколькими ACK-пакетами совместно с одним или более RST- или FIN-пакетами.

---
### Третья группа — это DDoS-атаки на уровень приложений (L7):
#### HTTP-флуд

Злоумышленник генерирует большое количество запросов, направленных на сервер-жертву, чтобы вынудить его выделять как можно больше ресурсов для обработки вредоносного трафика.

![](https://selectel.ru/blog/wp-content/uploads/2020/09/PR-14317_3.png)

Сервер получает избыточный объем HTTP-запросов клиентов, в результате чего все узлы связи становятся недоступными.
#### Атака с целью отказа приложения

Специфичный вид атак, который нацелен на выявление уязвимостей в неоптимизированном сайте или приложении. С помощью SQL-инъекций хакер провоцирует  зацикливание обращений и отказ всего сервера.
##### HTTP-флуд одиночными запросами

В отличие от обычного флуда, где злоумышленник атакует сервер-жертву потоком отдельных запросов, этот тип атаки предполагает отправку одного большого пакета, внутри которого одновременно передается 500-600 запросов.
#### Атака фрагментированными HTTP-пакетами

Алгоритм основан на отправке в адрес цели небольших  
фрагментов данных, которые невозможно собрать в единый объект. При такой   атаке устанавливается корректное HTTP-соединение с веб-сервером. Далее легитимные HTTP-пакеты разделяются на маленькие фрагменты, и их передают настолько медленно, насколько это позволяет тайм-аут сервера. Обходя таким образом  срабатывание механизмов защиты, атакующий незаметно приводит веб-сервер к отказу с помощью вредоносных ботов.
#### HTTP-флуд одиночными сессиями 

Атакующий превышает лимит сессий на стороне жертвы, чтобы беспрепятственно в рамках каждой HTTP-сессии отправлять множество запросов. Цель злоумышленника — заставить сервер выделить как можно больше ресурсов для обслуживания атаки.

---
### Другие типы кибератак

DDoS — не единственный способ атаки информационных систем. На практике встречаются также [[#АРТ-атака|APT-]], [[#MITM-атака|MITM-]] [[#Многовекторная атака|многовекторные]] и [[#АРТ-атака|APDoS-атаки]], [[#IP-спуфинг|IP-спуфинг]], а также [[#Атака нулевого дня|атаки нулевого дня]].
Некоторые киберугрозы не подпадают под чистую классификацию, поэтому выделены в отдельный блок.
#### АРТ-атака

Цель злоумышленника — найти на устройстве-жертве секретную или любую ценную информацию, которую можно использовать в своих целях. Хакер незаметно проникает в компьютерную сеть и изучает ее длительное время, отслеживает действия пользователей и анализирует перемещение данных. Чтобы получить доступ к нужной системе, хакеры эксплуатируют уязвимости, используют социальную инженерию и другие техники обхода защиты.
#### Многовекторная атака

Этот вид атак достаточно сложен в исполнении. При многовекторной DDoS-атаке хакер использует сразу несколько точек нападения и инструментов для вывода из строя целевой системы. 

![График по типам вредоносного трафика - DDoS-Guard](https://ddos-guard.net/uploads/Tip_vredonosnogo_trafika_D_Do_S_Guard_29c2ebbeb7.png)
#### Атака нулевого дня

Злоумышленник исследует новые и ранее неизвестные уязвимости в программном обеспечении, а затем использует их против выбранной цели. Эта кибератака опасна тем, что с момента ее обнаружения до полного устранения и смягчения последствий может пройти много часов. Тем временем злоумышленник может  получить несанкционированный доступ к информации или полностью  заблокировать веб-ресурс. На текущий момент не существует универсальной защиты от атаки нулевого дня, и без помощи специалистов справиться с ней практически невозможно.
#### IP-спуфинг

В DDoS спуфинг (фальсификация данных) используется как механизм усиления кибератаки. Хакеры выдают себя за надежные источники, чтобы получить доступ к конфиденциальной информации. Подмена происходит в изменении адреса отправителя, чтобы скрыть настоящий адрес атакующего.
#### APDoS-атака

APDoS реализует 5-8 векторов атак одновременно. Злоумышленник использует «слепые зоны» атакуемой организации и нападает сразу на несколько уровней сетей.
#### MITM-атака

Злоумышленник перехватывает трафик и заменяет связь между двумя сторонами, которые считают, что общаются друг с другом без третьих лиц. Атаки особенно распространены в общедоступных сетях Wi-Fi. Например, жертва думает, что работает напрямую с сайтом, в то время как злоумышленник перехватывает все данные, которые были введены: пароль, логин и другие.
